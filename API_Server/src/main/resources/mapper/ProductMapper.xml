<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ProductMapper">
	
	<select id="productAll" resultType="com.tmon.platform.api.dto.ProductDto">
		SELECT product_id, product_user_user_id, 
				sell_quantity, max_quantity, image_url, price, product_name, 
     			product_category_category_id AS category_id, 
     			CATEGORY.category_name AS category_name 
		FROM PRODUCT JOIN CATEGORY 
		WHERE CATEGORY.category_id = PRODUCT.product_category_category_id;
	</select>

	<select id="productByOrderId" resultType="com.tmon.platform.api.dto.ProductDto" parameterType="int">
		SELECT * FROM PRODUCT 
		WHERE product_id 
		IN (
			SELECT order_information_product_product_id 
			FROM ORDER_INFORMATION 
			WHERE ORDER_INFORMATION.order_information_reservation_order_reservation_id = #{order_id}
			)
	</select>
	
	<select id="productByCategoryId" resultType="com.tmon.platform.api.dto.ProductDto" parameterType="int">
		SELECT product_id, product_user_user_id, sell_quantity, max_quantity, image_url, price, product_name, 
    		  product_category_category_id AS category_id, CATEGORY.category_name AS category_name 
		FROM PRODUCT JOIN CATEGORY 
		WHERE CATEGORY.category_id = PRODUCT.product_category_category_id 
			AND PRODUCT.product_category_category_id=#{category_id};

	</select>
	
	
</mapper>